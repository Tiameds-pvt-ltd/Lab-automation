##-------------------------------------------------------------------------------#
##            Discover all capabilities of Qodana in our documentation           #
##             https://www.jetbrains.com/help/qodana/about-qodana.html           #
##-------------------------------------------------------------------------------#
#
#name: Qodana
#on:
#  workflow_dispatch:
#  pull_request:
#  push:
#    branches:
#      - main
#      - radiology-report
#
#jobs:
#  qodana:
#    runs-on: ubuntu-latest
#    permissions:
#      contents: write
#      pull-requests: write
#      checks: write
#    steps:
#      - uses: actions/checkout@v4
#        with:
#          ref: ${{ github.event.pull_request.head.sha }}
#          fetch-depth: 0
#      - name: 'Qodana Scan'
#        uses: JetBrains/qodana-action@v2025.2
#        env:
#          QODANA_TOKEN: ${{ secrets.QODANA_TOKEN }}
#        with:
#          # When pr-mode is set to true, Qodana analyzes only the files that have been changed
#          pr-mode: false
#          use-caches: true
#          post-pr-comment: true
#          use-annotations: true
#          # Upload Qodana results (SARIF, other artifacts, logs) as an artifact to the job
#          upload-result: false
#          # quick-fixes available in Ultimate and Ultimate Plus plans
#          push-fixes: 'none'



#-------------------------------------------------------------------------------#
#            Qodana local scan workflow (no token required)                     #
#-------------------------------------------------------------------------------#

name: Qodana Local
on:
  workflow_dispatch:
  pull_request:
  push:
    branches:
      - main
      - radiology-report

jobs:
  qodana-local:
    runs-on: ubuntu-latest
    steps:
      # Checkout the repository
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # Run Qodana scan locally (offline)
      - name: Run Qodana Scan
        uses: JetBrains/qodana-action@v2025.2
        with:
          pr-mode: false           # Scan full codebase
          use-caches: true         # Speed up repeated runs
          upload-result: true      # Upload SARIF/artifacts for review
          post-pr-comment: false   # Disabled (requires token)
          use-annotations: false   # Disabled (requires token)
          push-fixes: 'none'       # Disabled (requires Ultimate + token)
